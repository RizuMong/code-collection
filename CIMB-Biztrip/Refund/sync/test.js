var findLogs = [
  {
    activity: {
      id: "kLCTUVgIR",
      name: "Expense Biztrip 7 DP",
    },
    biztrip_category: {
      id: "l6tblrNIR",
      name: "Perjalanan Dinas Dalam Negeri - Day Trip - Flight Kurang dari 4 Jam",
    },
    budget_log_id: "7gb0eEuSR",
    company_id: 25236,
    completed_date: 1721888151076,
    created_at: 1721887310013,
    created_by: 1721840400000,
    direct_payment_id: "",
    division: {
      id: "pgVgFYQVg",
      name: "FSAC",
    },
    dp_status: "approved",
    dpp_amount: 3301435,
    execution_date: 1721888151076,
    id: "jnw3ePuSg",
    is_sync: "False",
    log_id: "df28RsuSg",
    log_integration_id: "118",
    passanger_guest: "SUBANDI@mailinator.com",
    position_initiator: {
      id: "IPA1J8QVR",
      name: "Business Support & Internal Control Specialist - 2",
    },
    rc_code: "1611-47077-3013",
    ref_id: "245",
    refund_amount: 3000000,
    refund_status: "CLOSED",
    scheduled_date: 1721888151076,
    sof_type: "BUDGET",
    status_amount: "Consume",
    summary_id: "GKQ26EuSg",
    t_integration_biztrip_direct_payment: "jnw3ePuSg",
    tax_formula: "BIZTRIP",
    transaction_amount: 3301435,
    transaction_date: 1721886785892,
    transaction_type: "Flight",
    travel_id: "4RHp6EuIg",
    travel_status: "CLOSED",
    updated_at: 1724137809623,
    updated_by: 157190,
    vendor_address: "Jakarta Selatan",
    vendor_address_object: {
      id: "xAAkjRgIg",
      name: "Jakarta Selatan",
    },
    vendor_bank_account_number: "12345678",
    vendor_bank_account_number_object: {
      id: "xAAkjRgIg",
      name: "12345678",
    },
    vendor_name: "Traveloka",
    vendor_name_object: {
      id: "xAAkjRgIg",
      name: "Traveloka",
    },
  },
  {
    activity: {
      id: "kLCTUVgIR",
      name: "Expense Biztrip 7 DP",
    },
    biztrip_category: {
      id: "l6tblrNIR",
      name: "Perjalanan Dinas Dalam Negeri - Day Trip - Flight Kurang dari 4 Jam",
    },
    budget_log_id: "HGas6EXIR",
    company_id: 25236,
    completed_date: 1721888151076,
    created_at: 1721887310568,
    created_by: 1721840400000,
    direct_payment_id: "",
    division: {
      id: "vk96dYQ4R",
      name: "COAG",
    },
    dp_status: "approved",
    dpp_amount: 3301435,
    execution_date: 1721888151076,
    id: "NsQqeEXSRz",
    is_sync: "False",
    log_id: "df28RsuSg",
    log_integration_id: "118",
    passanger_guest: "Ratna.DwiSetiyowati@mailinator.com",
    position_initiator: {
      id: "yVEnJ8wVgz",
      name: "Payment Manager I",
    },
    rc_code: "1611-47077-3005",
    ref_id: "246",
    refund_amount: 5000000,
    refund_status: "CLOSED",
    scheduled_date: 1721888151076,
    sof_type: "BUDGET",
    status_amount: "Consume",
    summary_id: "7PrBePXIR",
    t_integration_biztrip_direct_payment: "NsQqeEXSRz",
    tax_formula: "BIZTRIP",
    transaction_amount: 3301435,
    transaction_date: 1721886985925,
    transaction_type: "Flight",
    travel_id: "Y6GaeEXIRz",
    travel_status: "CLOSED",
    updated_at: 1724137829382,
    updated_by: 157190,
    vendor_address: "Jakarta Selatan",
    vendor_address_object: {
      id: "xAAkjRgIg",
      name: "Jakarta Selatan",
    },
    vendor_bank_account_number: "12345678",
    vendor_bank_account_number_object: {
      id: "xAAkjRgIg",
      name: "12345678",
    },
    vendor_name: "Traveloka",
    vendor_name_object: {
      id: "xAAkjRgIg",
      name: "Traveloka",
    },
  },
];

var findTax = {
  activity: {
    id: "kLCTUVgIR",
    name: "Expense Biztrip 7 DP",
  },
  activity_id_key: 133,
  amount_penalty: 8000000,
  amount_penalty_currency: {
    convertion_amount: 8000000,
    origin_amount: 8000000,
    origin_currency: "IDR",
    rate: 1,
    target_currency: "IDR",
  },
  company_id: 25236,
  created_at: 1724086800000,
  created_by: 166467,
  currency: {
    convertion_amount: 6602870,
    origin_amount: 6602870,
    origin_currency: "IDR",
    rate: 1,
    target_currency: "IDR",
  },
  direct_payment_id: {
    id: "xtcDm_jSR",
    name: "Expense Biztrip 7 DP",
  },
  direct_payment_use_penalty: true,
  dpp: 6602870,
  dpp_after_penalty: 6602870,
  dpp_after_penalty_currency: {
    convertion_amount: -1397130,
    origin_amount: -1397130,
    origin_currency: "IDR",
    rate: 1,
    target_currency: "IDR",
  },
  dpp_currency: {
    convertion_amount: 6602870,
    origin_amount: 6602870,
    origin_currency: "IDR",
    rate: 1,
    target_currency: "IDR",
  },
  id: "r85DiljIg",
  id_direct_payment_tax: "r85DiljIg",
  payment_amount: -1397130,
  payment_amount_currency: {
    convertion_amount: -1397130,
    origin_amount: -1397130,
    origin_currency: "IDR",
    rate: 1,
    target_currency: "IDR",
  },
  penalty: true,
  ppn: false,
  result: 0,
  result_currency: {
    convertion_amount: -1397130,
    origin_amount: -1397130,
    origin_currency: "IDR",
    rate: 1,
    target_currency: "IDR",
  },
  rounded: "No",
  tax_formula: {
    id: "8237823",
    name: "BIZTRIP",
  },
  total_source_of_funds: 6602870,
  total_source_of_funds_currency: {
    convertion_amount: 6602870,
    origin_amount: 6602870,
    origin_currency: "IDR",
    rate: 1,
    target_currency: "IDR",
  },
  total_source_of_funds_origin: 6602870,
  updated_at: 1724137901852,
  updated_by: 166467,
};

// Mengeliminasi duplikat kegiatan
var pure = findLogs.reduce(function (acc, each) {
  if (!acc.some(function (obj) { return obj.id === each.activity.id; })) {
    acc.push({ id: each.activity.id, activity: each.activity.name, amount: 0 });
  }
  return acc;
}, []);

pure.forEach(function (data) {
  var mapping_division = [];

  findLogs.forEach(function (each) {
    if (each.activity.id === data.id) {
      var division = mapping_division.find(function (div) {
        return div.division_id === each.division.id;
      });

      if (!division) {
        mapping_division.push({
          division_id: each.division.id,
          division_name: each.division.name,
          amount: each.transaction_amount || 0,
          rc_code: each.rc_code,
          summary_id: each.summary_id,
        });
      } else {
        division.amount += each.transaction_amount || 0;
      }
    }
  });

  mapping_division.forEach(function (div) {
    console.log({
      division: {
        id: div.division_id,
        name: div.rc_code + " - " + div.division_name,
      },
      tax: {
        id: findTax.id_direct_payment_tax,
        name: findTax.tax_formula.name,
      },
      currency3: {
        convertion_amount: div.amount,
        origin_amount: div.amount,
        origin_currency: "IDR",
        rate: 1,
        target_currency: "IDR",
      },
    });
  });
});

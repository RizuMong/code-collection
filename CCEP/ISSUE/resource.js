var request = {
  body: {
    resources: {
        "id": "IoKreYfKFlRRvtU",
        "name": "CAKRA SATYA INTERNUSA PT"
    },
    data: {
      resources: {
        address: "CITI SQUARE BUSINESS PARK 11840 JAKARTA",
        company_id: 27417,
        created_at: 1741765282905,
        created_by: 178617,
        id: "IoKreYfKFlRRvtU",
        "name": "CAKRA SATYA INTERNUSA PT",
        label: "CAKRA SATYA INTERNUSA PT",
        location: {
          id: "",
          name: "",
        },
        name: "CAKRA SATYA INTERNUSA PT",
        operation: {
          id: "",
          name: "",
        },
        phone_number: "62 21 2252561",
        status_active: true,
        updated_at: 1741765282951,
        updated_by: 178617,
        vendor_code: "324368",
        vendor_email: "FEBE.HEKSI@CSIINDONESIA.COM",
        vendor_id: "IoKreYfKFlRRvtU",
        vendor_name: "CAKRA SATYA INTERNUSA PT",
      },
      "service_period_end": 1747933200000,
      "service_period_start": 1745600400000,
      approver: "Garby Mukzi Pamessa",
      attachment: [
        {
          is_delete: false,
          name: "",
          url: "",
        },
      ],
      attachment_work_order: null,
      berita_acara: [],
      company: "CCBI",
      contractor_type: "FTE",
      cost_center: {
        id: "daj3ZhTXuSM847iO",
        label: "3550261130",
      },
      cost_center_description: "CCBI-Security-JK_HO - Administration",
      department: {
        code: "LGL",
        company_id: 27417,
        created_at: 1741143418110,
        created_by: 178617,
        department_id: "0dYZiPd1OswETsX7",
        department_name: "Legal",
        id: "0dYZiPd1OswETsX7",
        label: "Legal",
        name: "Legal",
        updated_at: 1741143418110,
        updated_by: 178617,
      },
      flag: 2,
      fte: "44",
      id: "RHv7xhlmmtF2ewUB",
      location: {
        area_location: "5457",
        code_location: "J8",
        company_id: 27417,
        created_at: 1741595137135,
        created_by: 178617,
        id: "7JBWAaXiaM3rd2S4",
        id_location: "7JBWAaXiaM3rd2S4",
        label: "Bekasi 1 Plant",
        name: "Bekasi 1 Plant",
        name_location: "Bekasi 1 Plant",
        operation_id: {
          id: "kAJ9WJDW4zd6KhJl",
          name: "Jakarta",
        },
        updated_at: 1741595137135,
        updated_by: 178617,
      },
      month_period: "May",
      notes: "WO Mei 2025",
      number_of_personel: "44",
      operation: {
        id: "kAJ9WJDW4zd6KhJl",
        label: "Jakarta",
      },
      position: {
        certification: [
          {
            id: "T4E3J0pVG3tF1zr7",
            name: "Safety Induction",
          },
        ],
        company_id: 27417,
        competency_required: "Senior High School",
        consumable_equipment: false,
        consumable_equipment_material: "0",
        contractor_type: "",
        created_at: 1741680639613,
        created_by: 178617,
        extra_cost_material: "220001010",
        gl_account_number: "805101204",
        gl_consumable_equipment: "0",
        id: "qTcZ4vPnBTjw3Z5H",
        label: "Security Guard",
        major: {
          id: "0dYqaJtEBE5hTY0y",
          name: "General",
        },
        management_fee_cost_material: "220000968",
        management_fee_material: "220001235",
        management_fee_overtime_material: "220001284",
        material_number: "220000938",
        name: "Security Guard",
        output_type: "",
        overtime_incentive_material: "220001283",
        pct: null,
        position_id: "qTcZ4vPnBTjw3Z5H",
        position_name: "Security Guard",
        position_requirement: "NA",
        skill_requirements: "Basic Security",
        type: "Specific",
        unit: "",
        updated_at: 1743135090042,
        updated_by: 180420,
        working_license: [
          {
            id: "n0zbdSKQZIMBqqYi",
            name: "KTA",
          },
        ],
      },
      position_type: "Specific",
      purpose: null,
      request_for: {
        id: "50004738",
        label: "Sukarno Sukarno",
      },
      request_number: "PAGAHCENQI",
      requested_by: "Garby Mukzi Pamessa ",
      requestor: {
        id: "Aer5GFKRzGGbs5CN",
        label: "Garby Mukzi Pamessa",
      },
      // resources: [],
      resources_custom: [
        {
          full_name: "Idhar Fidinillah",
          labour_supplier: "CAKRA SATYA INTERNUSA PT",
          link: "https://jojonomic-ccep-certificate-license.netlify.app/documents?id=10021632",
          ohs_expired: 1017766800000,
          personnel_id: "10021632",
          resources_custom: {
            full_name: "Idhar Fidinillah",
            id: "10021632",
            label: "Idhar Fidinillah",
            labour_supplier: "CAKRA SATYA INTERNUSA PT",
            name: "Idhar Fidinillah",
            ohs_expired: 1017766800000,
            personnel_id: "10021632",
          },
          "resources_custom--fk": {
            resources_custom: 0,
          },
          resources_custom2: [
            {
              full_name: "A. Faisal",
              id: "10021758",
              label: "A. Faisal",
              labour_supplier: "CAKRA SATYA INTERNUSA PT",
              name: "A. Faisal",
              ohs_expired: 1022173200000,
              personnel_id: "10021758",
            },
            {
              full_name: "A. Haris N",
              id: "10021923",
              label: "A. Haris N",
              labour_supplier: "CAKRA SATYA INTERNUSA PT",
              name: "A. Haris N",
              ohs_expired: 1017507600000,
              personnel_id: "10021923",
            },
            {
              full_name: "A. Joko",
              id: "10021913",
              label: "A. Joko",
              labour_supplier: "CAKRA SATYA INTERNUSA PT",
              name: "A. Joko",
              ohs_expired: 1017507600000,
              personnel_id: "10021913",
            },
          ],
          service_length_day: "18",
          service_period_end: 1747933200000,
          service_period_start: 1745600400000,
          supplier: {
            address: "CITI SQUARE BUSINESS PARK 11840 JAKARTA",
            company_id: 27417,
            created_at: 1741765282905,
            created_by: 178617,
            id: "IoKreYfKFlRRvtU",
            label: "CAKRA SATYA INTERNUSA PT",
            location: {
              id: "",
              name: "",
            },
            name: "CAKRA SATYA INTERNUSA PT",
            operation: {
              id: "",
              name: "",
            },
            phone_number: "62 21 2252561",
            status_active: true,
            updated_at: 1741765282951,
            updated_by: 178617,
            vendor_code: "324368",
            vendor_email: "FEBE.HEKSI@CSIINDONESIA.COM",
            vendor_id: "IoKreYfKFlRRvtU",
            vendor_name: "CAKRA SATYA INTERNUSA PT",
          },
          working_days: "5",
          year_period: "2025",
        },
      ],
  
    },
  }
};

function _log(msg) {
  console.log(msg);
};

// _log(request.body)

try {
  var isResourcesValid = Boolean(request.body.resources) && Boolean(request.body.resources.id) && Boolean(request.body.resources.name);
  var isServicePeriodStartValid = Boolean(request.body.data.service_period_start) && !isNaN(request.body.data.service_period_start);
  var isServicePeriodEndValid = Boolean(request.body.data.service_period_end) && !isNaN(request.body.data.service_period_end);

  console.log({
    isResourcesValid: isResourcesValid,
    isServicePeriodStartValid: isServicePeriodStartValid,
    isServicePeriodEndValid: isServicePeriodEndValid
  });
  

  var isPayloadValid = isResourcesValid && isServicePeriodStartValid && isServicePeriodEndValid;

  if (!isPayloadValid) {
    throw new Error('Payload is not valid!');
  };

  var payloadFunction = {
    supplier: {
      id: request.body.resources.id,
      name: request.body.resources.name
    },
    servicePeriodStart: request.body.data.service_period_start,
    servicePeriodEnd: request.body.data.service_period_end,
    positionType: 'Specific'
  }

} catch (err) {
  var response = {
    error: true,
    message: err.message,
    data: [],
  };

  _log(response);

  // _stopAutomation();
};


_log(payloadFunction);
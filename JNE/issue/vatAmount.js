var data_header = {
  "adjusted_insurance_admin_dpp": 13513.51,
  "branch_id": {
      "id": "ReFNB3fVg",
      "name": "CGK"
  },
  "branch_name": {
      "id": "ReFNB3fVg",
      "name": "JNE JAKARTA"
  },
  "branch_type": {
      "id": "ReFNB3fVg",
      "name": "CABANG UTAMA JNE"
  },
  "calculate_status": "Not Calculated",
  "cod_amount": 0,
  "company_id": 230,
  "confirmation": "Not Confirmed",
  "connote_bms_status": "Invoiced, FP not Generated",
  "created_at": 1736760432607,
  "created_by": 1922,
  "customer_id": {
      "id": "CGK_81041800",
      "name": "81041800"
  },
  "customer_name": {
      "id": "CGK_81041800",
      "name": "KAMI IDEA INDONESIA"
  },
  "customer_name_intext": "81041800 - KAMI IDEA INDONESIA",
  "customer_type": {
      "id": "8xsM8KbVg",
      "name": "CORPORATE"
  },
  "customer_type_name": {
      "id": "zKtHUKbVg",
      "name": "NA STANDAR"
  },
  "dasar_pengenaan_pajak": 5605000,
  "description": "Jasa Pengangkutan/Ekspedisi (Diluar Scope PPh 15) - CGK/GIMFEE/01/2412000274",
  "discount_amount_inv": 100000,
  "display_header": true,
  "flagging_credit_note": 0,
  "from_connote_date": 1732986000000,
  "id": "6q2mHbvNR",
  "ids": "6q2mHbvNR",
  "invoice_date": 1735578000000,
  "invoice_status": {
      "id": "9JBsCle7g",
      "name": "Open"
  },
  "invoicing_method": {
      "id": "65wee5qng",
      "name": "MULTIBRANCH INVOICE"
  },
  "invoicing_officer": {
      "id": "m8tOQdYVR",
      "name": "BCMSSUV.VIKA"
  },
  "invoicing_officer_name": "Nur Vika",
  "invoicing_type": {
      "id": "cm1msDw4R",
      "name": "Group Invoice - With Management Fee NA"
  },
  "invoicing_type_txt": "Group Invoice - With Management Fee NA",
  "journal_batch_number": "--",
  "lastupdby": "bcmssuv.vika@jne.co.id",
  "lastupddtm": "Jan  13,  2025,  17:29",
  "lastupdprocess": "aiQJyP8Vg - Calculate Summary Header",
  "local_parent_id": {
      "id": "gBrGdbYVRz",
      "name": "CGKKAMII0000001"
  },
  "local_parent_name": {
      "id": "gBrGdbYVRz",
      "name": "KAMI IDEA INDONESIA"
  },
  "master_invoice_parameter_id": {
      "id": "o4tiNbDHg",
      "name": "o4tiNbDHg"
  },
  "na_principal": {
      "id": "ReFNB3fVg",
      "name": "CGK"
  },
  "national_parent_id": {
      "id": "R6_0d1L4g",
      "name": "JNEKAMII0000002"
  },
  "national_parent_name": {
      "id": "R6_0d1L4g",
      "name": "KAMI IDEA INDONESIA"
  },
  "npwp_address": "JL KEMANG SELATAN RAYA NO.14A RT.4 RW.1, BANGKA, MAMPANG PRAPATAN, JAKARTA SELATAN ",
  "npwp_id": "82.483.858.5-014.000",
  "npwp_name": "PT. KAMI IDEA INDONESIA",
  "number_sequence": "CGK/GIMFEE/01/2412000274",
  "prepaid_tax_type": {
      "id": "Jn821UenR",
      "name": "Prepaid 23 - PPh 23 Dibayar Dimuka"
  },
  "revised_cancelled_journal_batch_number_allocation_revenue_management_fee_na": "--",
  "revised_journal_batch_number": "--",
  "revised_posting_date": 0,
  "revised_posting_status": "--",
  "revised_voucher_number": "--",
  "reward": 46375638,
  "service_group": [
      {
          "id": "4deGxtP4g",
          "name": "BOX - DOMESTIC"
      },
      {
          "id": "ZF6MbpEVg",
          "name": "ACE - DOMESTIC"
      },
      {
          "id": "BF6GbpEVg",
          "name": "CML - DOMESTIC"
      },
      {
          "id": "Vc6GbpPVg",
          "name": "JTR - DOMESTIC"
      },
      {
          "id": "B56MxtE4Rz",
          "name": "DIPLOMAT - DOMESTIC"
      },
      {
          "id": "vteGbpEVg",
          "name": "YES - DOMESTIC"
      },
      {
          "id": "m2eMxtE4g",
          "name": "OKE - DOMESTIC"
      },
      {
          "id": "32eGbtP4g",
          "name": "P2P - DOMESTIC"
      },
      {
          "id": "Eo6GbpEVg",
          "name": "PARCEL - DOMESTIC"
      },
      {
          "id": "n0eMbpP4R",
          "name": "QR - DOMESTIC"
      },
      {
          "id": "w06GbtEVR",
          "name": "REG - DOMESTIC"
      },
      {
          "id": "I16GbpP4R",
          "name": "SEA - DOMESTIC"
      },
      {
          "id": "P1eGxpEVR",
          "name": "SPS - DOMESTIC"
      },
      {
          "id": "Wx6GxpE4R",
          "name": "SSN - DOMESTIC"
      },
      {
          "id": "iB6MxpEVg",
          "name": "TRC - DOMESTIC"
      },
      {
          "id": "xB6GxtE4gz",
          "name": "WES - DOMESTIC"
      },
      {
          "id": "HYeMbtEVg",
          "name": "INT - INTERNATIONAL"
      },
      {
          "id": "IP6MxtE4g",
          "name": "SPS - INTERNATIONAL"
      },
      {
          "id": "BEeGbpPVR",
          "name": "CML - INTRACITY"
      },
      {
          "id": "gseMxtP4R",
          "name": "CTC - INTRACITY"
      },
      {
          "id": "tseGxpP4R",
          "name": "REG - INTRACITY"
      },
      {
          "id": "MUeGbpP4g",
          "name": "OKE - INTRACITY"
      },
      {
          "id": "sUeMxtEVR",
          "name": "SPS - INTRACITY"
      },
      {
          "id": "GQeMxpE4R",
          "name": "JTR - INTRACITY"
      },
      {
          "id": "xQ6GxpPVR",
          "name": "VIP - INTRACITY"
      },
      {
          "id": "6weGbtPVg",
          "name": "VVIP - INTRACITY"
      },
      {
          "id": "bl6MxtP4g",
          "name": "YES - INTRACITY"
      },
      {
          "id": "3_eGbtPVg",
          "name": "PELIKAN - INTRACITY"
      }
  ],
  "service_type": [
      {
          "id": "4deGxtP4g",
          "name": "BOX - DOMESTIC"
      },
      {
          "id": "ZF6MbpEVg",
          "name": "ACE - DOMESTIC"
      },
      {
          "id": "BF6GbpEVg",
          "name": "CML - DOMESTIC"
      },
      {
          "id": "Vc6GbpPVg",
          "name": "JTR - DOMESTIC"
      },
      {
          "id": "B56MxtE4Rz",
          "name": "DIPLOMAT - DOMESTIC"
      },
      {
          "id": "vteGbpEVg",
          "name": "YES - DOMESTIC"
      },
      {
          "id": "m2eMxtE4g",
          "name": "OKE - DOMESTIC"
      },
      {
          "id": "32eGbtP4g",
          "name": "P2P - DOMESTIC"
      },
      {
          "id": "Eo6GbpEVg",
          "name": "PARCEL - DOMESTIC"
      },
      {
          "id": "n0eMbpP4R",
          "name": "QR - DOMESTIC"
      },
      {
          "id": "w06GbtEVR",
          "name": "REG - DOMESTIC"
      },
      {
          "id": "I16GbpP4R",
          "name": "SEA - DOMESTIC"
      },
      {
          "id": "P1eGxpEVR",
          "name": "SPS - DOMESTIC"
      },
      {
          "id": "Wx6GxpE4R",
          "name": "SSN - DOMESTIC"
      },
      {
          "id": "iB6MxpEVg",
          "name": "TRC - DOMESTIC"
      },
      {
          "id": "xB6GxtE4gz",
          "name": "WES - DOMESTIC"
      },
      {
          "id": "HYeMbtEVg",
          "name": "INT - INTERNATIONAL"
      },
      {
          "id": "IP6MxtE4g",
          "name": "SPS - INTERNATIONAL"
      },
      {
          "id": "BEeGbpPVR",
          "name": "CML - INTRACITY"
      },
      {
          "id": "gseMxtP4R",
          "name": "CTC - INTRACITY"
      },
      {
          "id": "tseGxpP4R",
          "name": "REG - INTRACITY"
      },
      {
          "id": "MUeGbpP4g",
          "name": "OKE - INTRACITY"
      },
      {
          "id": "sUeMxtEVR",
          "name": "SPS - INTRACITY"
      },
      {
          "id": "GQeMxpE4R",
          "name": "JTR - INTRACITY"
      },
      {
          "id": "xQ6GxpPVR",
          "name": "VIP - INTRACITY"
      },
      {
          "id": "6weGbtPVg",
          "name": "VVIP - INTRACITY"
      },
      {
          "id": "bl6MxtP4g",
          "name": "YES - INTRACITY"
      },
      {
          "id": "3_eGbtPVg",
          "name": "PELIKAN - INTRACITY"
      }
  ],
  "site_id": {
      "id": "",
      "name": ""
  },
  "site_name": {
      "id": "",
      "name": ""
  },
  "stamp": 0,
  "status_calculate": "calculate",
  "status_connote": {
      "id": "l78wPKe7R",
      "name": "Invoiced, FP not Generated"
  },
  "sum_adjusted_insurance_admin": 15000,
  "sum_adjusted_insurance_admin_before_vat": 0,
  "sum_adjusted_insurance_admin_vat": 0,
  "sum_adjusted_insurance_amount": 30000,
  "sum_adjusted_insurance_premi": 0,
  "sum_discount_amount_awb": 0,
  "sum_goods_value": 0,
  "sum_original_amount": 0,
  "sum_revenue": 5905000,
  "summary_total_paid_amount": 0,
  "term_of_payment": {
      "id": "DKqz6qf4R",
      "name": "14"
  },
  "to_connote_date": 1733245200000,
  "total_adjusted_insurance": 0,
  "total_amount": 0,
  "total_amount_aft_discount": 0,
  "total_amount_dpp": 0,
  "total_amount_dpp_final": 5605000,
  "total_amount_dpp_pls": 0,
  "total_connote": 0,
  "total_discount": 0,
  "total_packing_charges": 0,
  "total_paid_amount": 0,
  "transaction_type": {
      "id": "0QEaUF6ng",
      "name": "Jasa Pengangkutan/Ekspedisi (Diluar Scope PPh 15)"
  },
  "updated_at": 1736764614613,
  "updated_by": 1922,
  "vat_amount": 0,
  "vat_invoice_header": 61655,
  "vat_out_cod_fee": {
      "id": "lCGqdpR4R",
      "name": "PPN 11%"
  },
  "vat_out_cod_fee_type": {
      "id": "5Te6SQAVg",
      "name": "01"
  },
  "vat_out_tariff": {
      "id": "HFgv0pRVg",
      "name": "PPN 1.1%"
  },
  "vat_out_tariff_header_incentive": {
      "id": "HFgv0pRVg",
      "name": "1.1%"
  },
  "vat_out_tariff_header_ops_cost": {
      "id": "HFgv0pRVg",
      "name": "1.1%"
  },
  "vat_out_tariff_header_rev_alloc": {
      "id": "HFgv0pRVg",
      "name": "1.1%"
  },
  "vat_out_tariff_header_royalti": {
      "id": "lCGqdpR4R",
      "name": "11%"
  },
  "vat_out_tariff_number": 1.1,
  "vat_out_type": {
      "id": "VxdFUYSVg",
      "name": "05"
  },
  "vat_out_type_header_incentive": {
      "id": "VxdFUYSVg",
      "name": "05"
  },
  "vat_out_type_header_ops_cost": {
      "id": "VxdFUYSVg",
      "name": "05"
  },
  "vat_out_type_header_rev_alloc": {
      "id": "VxdFUYSVg",
      "name": "05"
  },
  "vat_out_type_header_royalti": {
      "id": "5Te6SQAVg",
      "name": "01"
  },
  "voucher_number": "--"
};

var request = {
  "adjusted_insurance_admin": 5000,
  "adjusted_insurance_admin_dpp": 0,
  "adjusted_insurance_premi": 5000,
  "alloc_incentive_to_own_incentive": 0,
  "alloc_ops_cost_to_ho_ops_cost": 0,
  "alloc_royalty_to_ho_royalti": 0,
  "cod_amount": 0,
  "cod_fee_amount": 0,
  "cod_fee_amount_dpp": 0,
  "company_id": 230,
  "created_at": 1736764666767,
  "created_by": 1922,
  "currency": {
      "id": "Mi9jQZi4R",
      "name": "IDR"
  },
  "dasar_pengenaan_pajak": 0,
  "description": "Jasa Pengangkutan/Ekspedisi (Diluar Scope PPh 15) - (Origin BDO)",
  "discount_amount_awb": 100000,
  "discount_amount_inv": 0,
  "exchange_rate": 1,
  "id": "l8YZ5xvNg",
  "ids": "l8YZ5xvNg",
  "import_id": "NLLWcxvHg",
  "invoice_number": "CGK/GIMFEE/01/2412000274",
  "na_principal_text": "CGK",
  "origin_branch_id": "BDO",
  "original_amount": 3567300,
  "original_insurance_admin": 0,
  "original_insurance_premi": 0,
  "other_charges": 0,
  "packing": 0,
  "reward": 0,
  "row": 1,
  "stamp": 0,
  "surcharge": 0,
  "total_adjusted_insurance": 0,
  "total_amount": 0,
  "total_amount_dpp": 0,
  "total_packing_charges": 0,
  "total_paid_amount": 0,
  "transaction_type_text": "Jasa Pengangkutan/Ekspedisi (Diluar Scope PPh 15)",
  "updated_at": 1736764666767,
  "updated_by": 1922,
  "vat_amount": 0
}

var insuranceVAT = {
  "error": true,
  "formula_dpp": 1,
  "message": "Success get Insurance VAT!",
  "tax_rate_number": 11,
  "vat_insurance": 0.11,
  "vat_insurance_admin": 0.11,
  "vat_insurance_admin_before": 1.11
}

var _adjusted_insurance_admin_dpp = 0
var _dasar_pengenaan_pajak = 0
// end penambahan baru 08/01/2025 -SG


var totalAmountAfterDisc = request.original_amount - request.discount_amount_awb + request.packing + request.surcharge + request.other_charges;
_dasar_pengenaan_pajak = totalAmountAfterDisc * insuranceVAT.formula_dpp // add SG 08/01/2025
var vatAmountTarif = parseFloat(data_header.vat_out_tariff.name.replace(/[^1234567890.]/g, '')) / 100
//var vatAmount = totalAmountAfterDisc * vatAmountTarif; 
var vatAmount = _dasar_pengenaan_pajak * vatAmountTarif; // change SG 08/01/2025
// modif vatAmount dari dpp 08-Jan-25 14.15
//var vatAmount = Math.floor(_dasar_pengenaan_pajak * (insuranceVAT.tax_rate_number / 100)); // change SG 08/01/2025

//vatAmount = Math.floor(vatAmount)
//modif 29-05-23 13.35 wib sama field VAT Amount ini di round 2 aja ya om biar sama hasilnya kayak yg bawah..kalo di rounddown 0 per baris hasilnya jadi beda
vatAmount = parseFloat(vatAmount.toFixed(2));


console.log(vatAmount);